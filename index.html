<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>Slip Manager</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@400;500;600;700&family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <meta name="theme-color" content="#0ea5a4">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
</head>
<body>
  <div class="bg-shape shape-a"></div>
  <div class="bg-shape shape-b"></div>
  <div class="bg-shape shape-c"></div>

  <main class="app">
    <!-- ‚îÄ‚îÄ‚îÄ Header ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <header class="hero card">
      <div class="hero-icon">
        <svg viewBox="0 0 40 40" width="40" height="40" fill="none" stroke="#fff" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"><rect x="5" y="3" width="30" height="34" rx="4"/><path d="M12 12h16M12 18h10M12 24h14"/><circle cx="28" cy="28" r="7" fill="#06b6d4" stroke="#fff" stroke-width="2"/><path d="M26 28h4M28 26v4" stroke="#fff" stroke-width="1.8"/></svg>
      </div>
      <div class="hero-text">
        <h1>Slip Manager</h1>
        <p class="subtitle">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ ‡∏≠‡πà‡∏≤‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á</p>
      </div>
    </header>

    <!-- ‚îÄ‚îÄ‚îÄ Upload ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <section class="controls card" id="uploadSection">
      <label id="dropZone" class="drop-zone" for="slipInput">
        <div class="drop-zone-content">
          <div class="drop-icon-wrap">
            <svg class="drop-icon" viewBox="0 0 48 48" width="44" height="44" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="6" y="6" width="36" height="36" rx="8" opacity=".3"/>
              <path d="M24 30V16m0 0l-6 6m6-6l6 6"/>
              <path d="M14 34h20"/>
            </svg>
          </div>
          <p class="drop-text">‡∏•‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏•‡∏¥‡∏õ‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</p>
          <p class="drop-subtext">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö JPG, PNG, WEBP ‚Äî ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡πÑ‡∏ü‡∏•‡πå</p>
        </div>
        <span class="drop-btn">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M8 3v10M3 8h10"/></svg>
          ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏•‡∏¥‡∏õ
        </span>
        <input id="slipInput" type="file" accept="image/*" multiple>
      </label>

      <div class="upload-info">
        <p id="fileCountText" class="file-count">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå</p>
      </div>

      <div class="actions">
        <button id="scanBtn" type="button" class="btn-scan">
          <svg width="18" height="18" viewBox="0 0 18 18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="8" cy="8" r="5.5"/><path d="M12 12l4 4"/></svg>
          <span class="btn-text">‡∏≠‡πà‡∏≤‡∏ô‡∏™‡∏•‡∏¥‡∏õ</span>
        </button>
        <button id="clearBtn" type="button" class="secondary">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M2 4h12M5 4V3a1 1 0 011-1h4a1 1 0 011 1v1M6 7v5M10 7v5"/><path d="M3 4l1 10a1 1 0 001 1h6a1 1 0 001-1l1-10"/></svg>
          ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå
        </button>
      </div>

      <div class="status-wrap">
        <div id="scanSpinner" class="scan-spinner" style="display:none;">
          <div class="spinner-ring"></div>
          <span>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡πà‡∏≤‡∏ô‚Ä¶</span>
        </div>
        <p id="statusText" class="status-text">‡∏£‡∏≠‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏™‡∏•‡∏¥‡∏õ</p>
        <div class="progress-track" aria-hidden="true">
          <div id="progressBar" class="progress-bar"></div>
        </div>
      </div>
    </section>

    <!-- ‚îÄ‚îÄ‚îÄ Results ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <section class="card results-card">
      <div class="section-header">
        <h2>
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"><rect x="2" y="3" width="16" height="14" rx="3"/><path d="M2 8h16M7 8v9"/></svg>
          ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
        </h2>
      </div>

      <div id="sumRow" class="sum-banner" style="display:none;">
        <div class="sum-left">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="10" cy="10" r="8"/><path d="M10 6v4l3 2"/></svg>
          <span class="sum-label">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°</span>
        </div>
        <strong id="sumAmount"></strong>
      </div>

      <div class="table-actions">
        <button id="importExcelBtn" type="button" class="small-btn ghost-btn">
          <svg width="15" height="15" viewBox="0 0 15 15" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"><path d="M7.5 1v9M4 7.5l3.5 3.5L11 7.5M2 13h11"/></svg>
          Import
        </button>
        <button id="exportBtn" type="button" class="small-btn ghost-btn">
          <svg width="15" height="15" viewBox="0 0 15 15" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"><path d="M7.5 10V1M4 3.5L7.5 0 11 3.5M2 13h11"/></svg>
          Export
        </button>
        <button id="selectAllBtn" type="button" class="secondary small-btn">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
        <button id="deleteSelectedBtn" type="button" class="danger small-btn">‡∏•‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</button>
      </div>

      <input id="importExcelInput" type="file" accept=".xlsx,.xls" hidden>

      <p class="hint edit-hint">üí° ‡πÅ‡∏ï‡∏∞/‡∏î‡∏±‡∏ö‡πÄ‡∏ö‡∏¥‡∏•‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏ã‡∏•‡∏•‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>

      <div class="table-wrap">
        <table class="result-table">
          <thead>
            <tr>
              <th class="check-col"><span class="sr-only">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</span></th>
              <th class="order-col">#</th>
              <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</th>
              <th>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ä‡πà‡∏ß‡∏¢‡∏à‡∏≥</th>
            </tr>
          </thead>
          <tbody id="resultBody">
            <tr class="empty-row">
              <td colspan="4">
                <div class="empty-state">
                  <svg width="36" height="36" viewBox="0 0 36 36" fill="none" stroke="#b0c8d8" stroke-width="1.5" stroke-linecap="round"><rect x="4" y="4" width="28" height="28" rx="6"/><path d="M12 18h12M18 12v12" opacity=".4"/></svg>
                  <span>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</span>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- ‚îÄ‚îÄ‚îÄ Footer Note ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <footer class="card note-card">
      <p class="note-text">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"><circle cx="8" cy="8" r="6.5"/><path d="M8 5v3M8 10.5v.5"/></svg>
        ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡πÑ‡∏ó‡∏¢‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" ‡πÅ‡∏•‡∏∞ "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ä‡πà‡∏ß‡∏¢‡∏à‡∏≥"
      </p>
    </footer>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="script.js"></script>
</body>
</html>
